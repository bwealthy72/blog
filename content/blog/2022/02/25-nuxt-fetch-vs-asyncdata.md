---
title: NuxtJS에서 API를 가져올 때 fetch 와 asyncData 차이
tags:
  - nuxt
  - fetch
  - asyncdata
---

Nuxt에서 API를 호출할 때 사용하는 훅이 두 가지가 있다. 바로 fetch와 asyncData. 블로그를 만들면서 이 두 개중 어떤 것을 가져오는 게 좋을 지 고민했는데, 어떤 기준으로 어떤 훅을 사용했는지 정리했다.

<!--more-->

## 비교

### 사용할 수 있는 컴포넌트

- `asyncData`: `pages`의 컴포넌트에서만 사용 가능하다.
- `fetch`: 어떤 컴포넌트든 사용 가능하다.

### this 사용 가능 여부

- `asyncData`: **this를 사용하지 못한다.** 대신 context를 인자로 받는다.
- `fetch`: **this를 사용 가능하다.**

### 결과 데이터 사용 방식

- `asyncData`: return으로 반환하고 이 값은 **data와 병합하여 같이 사용**된다.
- `fetch`: this를 사용할 수 있기 때문에 **data에 미리 값을 두고 이 값을 변경하는 식으로 사용**한다.

### 에러가 났을 때 렌더링 차이

- `asnycData`: **로직이 끝날 때까지 페이지 전환이 이루어지지 않는다.** 에러가 발생 시 에러 경로로 이동한다.
- `fetch`: **$fetchState를 통해 pending, error 상태 값을 가져와서 해당 페이지에 반영(스타일링) 할 수 있다.**

### 호출 차이

- `asyncData`: 페이지를 로드할 때마다 호출된다.
- `fetch`: 초기 페이지 렌더링 될때 서버사이드에서 호출, 컴포넌트가 마운트 된 후 클라이언트에서 호출. `this.$fetch()`를 통해 여러 번 호출이 가능하며, `activated` hook을 통해 동일한 페이지로 이동할 때 조건에 따라 호출하게 할 수 있다.

### 캐시 사용 여부

- `asyncData`: 캐시를 사용하지 않는다.
- `fetch`: 캐시를 사용하여 한 번 방문했던 곳에서 원하는 데이터를 저장할 수 있다.

## 결론

사실 둘 다 API 호출하는 데에 사용할 수 있다. 그래서 내 생각엔 복잡한 로직이 아니라면 `asyncData`를, 에러 처리나 자주 호출해야하는 상황이 있다면 `fetch`를 쓰면 어떨까 생각이 든다.
